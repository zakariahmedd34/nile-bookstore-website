{% extends "base.html" %}

{% block title %}Wishlist - Nile Bookstore{% endblock %}

{% block content %}
<div class="page-container">
  <header class="page-header">
    <h1>Your Wishlist</h1>
    <p class="muted">Books you saved for later.</p>
  </header>

  {% if wishlist_items and wishlist_items|length > 0 %}
    <div class="wishlist-grid">
      {% for item in wishlist_items %}
        <div class="wishlist-card" data-book-id="{{ item.book.id }}">
          <div class="wishlist-card__img">
            {% if item.book.image_url %}
              <img src="{{ item.book.image_url }}" alt="{{ item.book.title }}">
            {% else %}
              <div class="img-placeholder">No image</div>
            {% endif %}
          </div>

          <div class="wishlist-card__body">
            <h3 class="wishlist-title">{{ item.book.title }}</h3>
            <p class="wishlist-author muted">{{ item.book.author }}</p>

            <div class="wishlist-meta">
              <span class="price">
                {% if item.book.price is not none %}
                  EGP {{ "%.2f"|format(item.book.price) }}
                {% else %}
                  Price N/A
                {% endif %}
              </span>
              {% if item.book.category %}
                <span class="tag">{{ item.book.category.name }}</span>
              {% endif %}
            </div>

            <div class="wishlist-actions">
              <a class="btn btn-secondary" href="{{ url_for('book_details', book_id=item.book.id) }}">
                View
              </a>

              <form method="POST" action="{{ url_for('add_to_cart', book_id=item.book.id) }}">
                <input type="hidden" name="quantity" value="1">
                <button type="submit" class="btn btn-primary">Add to Cart</button>
              </form>

              <form method="POST" action="{{ url_for('remove_from_wishlist', book_id=item.book.id) }}">
                <button type="submit" class="btn btn-danger">Remove</button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="empty-state">
      <h2>Wishlist is empty</h2>
      <p class="muted">Browse books and click “Add to Wishlist” to save items here.</p>
      <a class="btn btn-primary" href="{{ url_for('books_page') }}">Browse Books</a>
    </div>
  {% endif %}
</div>
{% endblock %}
